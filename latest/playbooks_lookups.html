

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script type="text/javascript" src="//www.redhat.com/dtm.js"></script>

  <!-- Google Tag Manager Data Layer -->
  <script>
   dataLayer = [];
  </script>
  <!-- End Google Tag Manager Data Layer -->




  
  <title>Lookups &mdash; Ansible Documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  
  

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'./',
        VERSION:'2.4',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  false
      };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.min.css" type="text/css" />
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Ansible Documentation" href="index.html"/>
        <link rel="up" title="Templating (Jinja2)" href="playbooks_templating.html"/>
        <link rel="next" title="Python Version and Templating" href="playbooks_python_version.html"/>
        <link rel="prev" title="Tests" href="playbooks_tests.html"/> 

  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

  <style>
    .search-reset-start {
        color: #463E3F;
        float: right;
        position: relative;
        top: -25px;
        left: -10px;
        z-index: 10;
     }
     .search-reset-start:hover {
        cursor: pointer;
        color: #2980B9;
     }
     #search-box-id {
        padding-right: 25px;
     }
  </style>

  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300'
    rel='stylesheet' type='text/css'>

</head>

<body class="wy-body-for-nav">

  <!-- Google Tag Manager -->
  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PSB293" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-PSB293');</script>
  <!-- End Google Tag Manager -->

    <div class="DocSite-globalNav ansibleNav">
        <ul>
            <li><a href="https://www.ansible.com/ansiblefest" target="_blank">AnsibleFest</a></li>
            <li><a href="https://www.ansible.com/tower" target="_blank">Products</a></li>
            <li><a href="https://www.ansible.com/community" target="_blank">Community</a></li>
            <li><a href="https://www.ansible.com/webinars-training" target="_blank">Webinars & Training</a></li>
            <li><a href="https://www.ansible.com/blog" target="_blank">Blog</a></li>
        </ul>
    </div>

  <a class="DocSite-nav" href="/">
    <img class="DocSiteNav-logo"
      src="_static/images/logo_invert.png"
      alt="Ansible Logo">
    <div class="DocSiteNav-title">
      Documentation
    </div>
  </a>

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">

      <div style="background-color:#5bbdbf;height=80px;margin:'auto auto auto auto'">
        <a class="DocSiteProduct-header DocSiteProduct-header--core" href="/">
            <div class="DocSiteProduct-productName">
                <div class="DocSiteProduct-logoText">
                    Ansible  
                    <div class="DocSiteProduct-CurrentVersion" align="right">
                      v2.4
                  </div>
                </div>
            </div>
        </a>
        

          <div class="DocSiteProduct-CheckVersionPara">For previous versions, see the  <a class="DocSiteProduct-versionheader" href="/#coreversionselect">documentation archive.</a></div>
      </div>

      <div id="menu-id" class="wy-menu wy-menu-vertical" data-spy="affix">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro_installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_inventory.html">Inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_dynamic_inventory.html">Dynamic Inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_patterns.html">Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_adhoc.html">Introduction To Ad-Hoc Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_configuration.html">Configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_bsd.html">BSD Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_windows.html">Windows Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_networking.html">Networking Support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart Video</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="playbooks.html">Playbooks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="playbooks_intro.html">Intro to Playbooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_reuse.html">Creating Reusable Playbooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_variables.html">Variables</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="playbooks_templating.html">Templating (Jinja2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_conditionals.html">Conditionals</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_loops.html">Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_blocks.html">Blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_strategies.html">Strategies</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_best_practices.html">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="playbooks_special_topics.html">Playbooks: Special Topics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="become.html">Become (Privilege Escalation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_acceleration.html">Accelerated Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_async.html">Asynchronous Actions and Polling</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_checkmode.html">Check Mode (&#8220;Dry Run&#8221;)</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_debugger.html">Playbook Debugger</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_delegation.html">Delegation, Rolling Updates, and Local Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_environment.html">Setting the Environment (and Working With Proxies)</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_environment.html#working-with-language-specific-version-managers">Working With Language-Specific Version Managers</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_error_handling.html">Error Handling In Playbooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_advanced_syntax.html">Advanced Syntax</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Lookups</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_prompts.html">Prompts</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_tags.html">Tags</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_vault.html">Using Vault in playbooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_startnstep.html">Start and Step</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_keywords.html">Directives Glossary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">About Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modules_intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="common_return_values.html">Return Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules_support.html">Module Maintenance &amp; Support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules_by_category.html">Module Index</a><ul>
<li class="toctree-l2"><a class="reference internal" href="list_of_all_modules.html">All Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_cloud_modules.html">Cloud Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_clustering_modules.html">Clustering Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_commands_modules.html">Commands Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_crypto_modules.html">Crypto Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_database_modules.html">Database Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_files_modules.html">Files Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_identity_modules.html">Identity Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_inventory_modules.html">Inventory Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_messaging_modules.html">Messaging Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_monitoring_modules.html">Monitoring Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_net_tools_modules.html">Net Tools Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_network_modules.html">Network Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_notification_modules.html">Notification Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_packaging_modules.html">Packaging Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_remote_management_modules.html">Remote Management Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_source_control_modules.html">Source Control Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_storage_modules.html">Storage Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_system_modules.html">System Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_utilities_modules.html">Utilities Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_web_infrastructure_modules.html">Web Infrastructure Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="list_of_windows_modules.html">Windows Modules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vault.html">Ansible Vault</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vault.html#what-can-be-encrypted-with-vault">What Can Be Encrypted With Vault</a></li>
<li class="toctree-l2"><a class="reference internal" href="vault.html#creating-encrypted-files">Creating Encrypted Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="vault.html#editing-encrypted-files">Editing Encrypted Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="vault.html#rekeying-encrypted-files">Rekeying Encrypted Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="vault.html#encrypting-unencrypted-files">Encrypting Unencrypted Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="vault.html#decrypting-encrypted-files">Decrypting Encrypted Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="vault.html#viewing-encrypted-files">Viewing Encrypted Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="vault.html#use-encrypt-string-to-create-encrypted-variables-to-embed-in-yaml">Use encrypt_string to create encrypted variables to embed in yaml</a></li>
<li class="toctree-l2"><a class="reference internal" href="vault.html#vault-ids-and-multiple-vault-passwords">Vault Ids and Multiple Vault Passwords</a></li>
<li class="toctree-l2"><a class="reference internal" href="vault.html#providing-vault-passwords">Providing Vault Passwords</a></li>
<li class="toctree-l2"><a class="reference internal" href="vault.html#speeding-up-vault-operations">Speeding Up Vault Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="vault.html#vault-format">Vault Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="vault.html#vault-payload-format-1-1">Vault Payload Format 1.1</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="command_line_tools.html">Command Line Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ansible.html">ansible</a></li>
<li class="toctree-l2"><a class="reference internal" href="ansible-playbook.html">ansible-playbook</a></li>
<li class="toctree-l2"><a class="reference internal" href="ansible-vault.html">ansible-vault</a></li>
<li class="toctree-l2"><a class="reference internal" href="ansible-galaxy.html">ansible-galaxy</a></li>
<li class="toctree-l2"><a class="reference internal" href="ansible-console.html">ansible-console</a></li>
<li class="toctree-l2"><a class="reference internal" href="ansible-config.html">ansible-config</a></li>
<li class="toctree-l2"><a class="reference internal" href="ansible-doc.html">ansible-doc</a></li>
<li class="toctree-l2"><a class="reference internal" href="ansible-inventory.html">ansible-inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="ansible-pull.html">ansible-pull</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="guides.html">Detailed Guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="guide_aws.html">Amazon Web Services Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_azure.html">Getting Started with Azure</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_rax.html">Rackspace Cloud Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_gce.html">Google Cloud Platform Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_cloudstack.html">CloudStack Cloud Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_vagrant.html">Using Vagrant and Ansible</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_rolling_upgrade.html">Continuous Delivery and Rolling Upgrades</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_docker.html">Getting Started with Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_packet.html">Using Ansible with the Packet host</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dev_guide/index.html">Developer Information</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dev_guide/index.html#ansible-developer-guide">Ansible Developer Guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tower.html">Ansible Tower</a></li>
<li class="toctree-l1"><a class="reference internal" href="community.html">Community Information &amp; Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="community.html#ansible-users">Ansible Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="community.html#for-current-and-prospective-developers">For Current and Prospective Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="community.html#other-topics">Other Topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="community.html#community-code-of-conduct">Community Code of Conduct</a></li>
<li class="toctree-l2"><a class="reference internal" href="community.html#contributors-license-agreement">Contributors License Agreement</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="galaxy.html">Ansible Galaxy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="galaxy.html#the-website">The Website</a></li>
<li class="toctree-l2"><a class="reference internal" href="galaxy.html#the-command-line-tool">The command line tool</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="test_strategies.html">Testing Strategies</a><ul>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#integrating-testing-with-ansible-playbooks">Integrating Testing With Ansible Playbooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#the-right-level-of-testing">The Right Level of Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#check-mode-as-a-drift-test">Check Mode As A Drift Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#modules-that-are-useful-for-testing">Modules That Are Useful for Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#testing-lifecycle">Testing Lifecycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#integrating-testing-with-rolling-updates">Integrating Testing With Rolling Updates</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#achieving-continuous-deployment">Achieving Continuous Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-can-i-set-the-path-or-any-other-environment-variable-for-a-task-or-entire-playbook">How can I set the PATH or any other environment variable for a task or entire playbook?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-handle-different-machines-needing-different-user-accounts-or-ports-to-log-in-with">How do I handle different machines needing different user accounts or ports to log in with?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-get-ansible-to-reuse-connections-enable-kerberized-ssh-or-have-ansible-pay-attention-to-my-local-ssh-config-file">How do I get ansible to reuse connections, enable Kerberized SSH, or have Ansible pay attention to my local SSH config file?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-configure-a-jump-host-to-access-servers-that-i-have-no-direct-access-to">How do I configure a jump host to access servers that I have no direct access to?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-speed-up-management-inside-ec2">How do I speed up management inside EC2?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-handle-python-pathing-not-having-a-python-2-x-in-usr-bin-python-on-a-remote-machine">How do I handle python pathing not having a Python 2.X in /usr/bin/python on a remote machine?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#what-is-the-best-way-to-make-content-reusable-redistributable">What is the best way to make content reusable/redistributable?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#where-does-the-configuration-file-live-and-what-can-i-configure-in-it">Where does the configuration file live and what can I configure in it?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-disable-cowsay">How do I disable cowsay?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-see-a-list-of-all-of-the-ansible-variables">How do I see a list of all of the ansible_ variables?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-see-all-the-inventory-vars-defined-for-my-host">How do I see all the inventory vars defined for my host?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-loop-over-a-list-of-hosts-in-a-group-inside-of-a-template">How do I loop over a list of hosts in a group, inside of a template?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-access-a-variable-name-programmatically">How do I access a variable name programmatically?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-access-a-variable-of-the-first-host-in-a-group">How do I access a variable of the first host in a group?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-copy-files-recursively-onto-a-target-host">How do I copy files recursively onto a target host?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-access-shell-environment-variables">How do I access shell environment variables?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-generate-crypted-passwords-for-the-user-module">How do I generate crypted passwords for the user module?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#can-i-get-training-on-ansible">Can I get training on Ansible?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#is-there-a-web-interface-rest-api-etc">Is there a web interface / REST API / etc?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-submit-a-change-to-the-documentation">How do I submit a change to the documentation?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-keep-secret-data-in-my-playbook">How do I keep secret data in my playbook?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#when-should-i-use-also-how-to-interpolate-variables-or-dynamic-variable-names">When should I use {{ }}? Also, how to interpolate variables or dynamic variable names</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#why-don-t-you-ship-in-x-format">Why don&#8217;t you ship in X format?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#i-don-t-see-my-question-here">I don&#8217;t see my question here</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="config.html#common-options">Common Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#environment-variables">Environment Variables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="YAMLSyntax.html">YAML Syntax</a><ul>
<li class="toctree-l2"><a class="reference internal" href="YAMLSyntax.html#yaml-basics">YAML Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="YAMLSyntax.html#gotchas">Gotchas</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="porting_guides.html">Ansible Porting Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_3_support.html">Python 3 Support</a><ul>
<li class="toctree-l2"><a class="reference internal" href="python_3_support.html#testing-python-3-with-commands-and-playbooks">Testing Python 3 with commands and playbooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_3_support.html#testing-python-3-module-support">Testing Python 3 module support</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_3_support.html#what-to-do-if-an-incompatibility-is-found">What to do if an incompatibility is found</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release_and_maintenance.html">Release and maintenance</a><ul>
<li class="toctree-l2"><a class="reference internal" href="release_and_maintenance.html#release-cycle">Release cycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="release_and_maintenance.html#release-status">Release status</a></li>
<li class="toctree-l2"><a class="reference internal" href="release_and_maintenance.html#development-and-stable-version-maintenance-workflow">Development and stable version maintenance workflow</a></li>
</ul>
</li>
</ul>

        


    <div class="DocSite-sideNav ansibleNav">
       <ul class="">
       <li><a href="https://www.ansible.com/ansiblefest" target="_blank">AnsibleFest</a></li>
       <li><a href="https://www.ansible.com/tower" target="_blank">Products</a></li>
       <li><a href="https://www.ansible.com/community" target="_blank">Community</a></li>
       <li><a href="https://www.ansible.com/webinars-training" target="_blank">Webinars & Training</a></li>
       <li><a href="https://www.ansible.com/blog" target="_blank">Blog</a></li>
       </ul>
     </div>

    <!-- changeable widget -->
    <div id="sideBanner">
    <br/>
    <a href="https://www.ansible.com/docs-left?utm_source=docs">
      <img style="border-width:0px;" src="https://cdn2.hubspot.net/hubfs/330046/docs-graphics/ASB-docs-left-rail.png" />
    </a>
    </div>


      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="/">Ansible Documentation</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">

          <!-- Banner ads
          <div class="DocSiteBanner">
            <a class="DocSiteBanner-imgWrapper"
                href="https://www.ansible.com/docs-top?utm_source=docs">
                <img src="https://cdn2.hubspot.net/hubfs/330046/docs-graphics/ASB-docs-top-left.png">
            </a>
            <a class="DocSiteBanner-imgWrapper"
                href="https://www.ansible.com/docs-top?utm_source=docs">
                <img src="https://cdn2.hubspot.net/hubfs/330046/docs-graphics/ASB-docs-top-right.png">
            </a>
        </div> -->

          <ul class="wy-breadcrumbs">
  <li><a href="index.html">Docs</a> &raquo;</li>
  <li><a href="">Lookups</a></li>
  
    <li class="wy-breadcrumbs-aside">
      <a href="https://github.com/ansible/ansible/blob/devel/docs/docsite/rst/playbooks_lookups.rst" class="icon icon-github"> Edit on GitHub</a>
    </li>
  
</ul>
<hr/>

          <div id="page-content">
          
  <div class="section" id="lookups">
<h1><a class="toc-backref" href="#id3">Lookups</a><a class="headerlink" href="#lookups" title="Permalink to this headline">¶</a></h1>
<p>Lookup plugins allow access of data in Ansible from outside sources. Like all templating, these plugins are evaluated on the Ansible control
machine, and can include reading the filesystem but also contacting external datastores and services.
These values are then made available using the standard templating system in Ansible, and are typically used to load variables or templates with information from those systems.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is considered an advanced feature, and many users will probably not rely on these features.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Lookups occur on the local computer, not on the remote computer.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Lookups are executed with a cwd relative to the role or play, as opposed to local tasks which are executed with the cwd of the executed script.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since 1.9 you can pass wantlist=True to lookups to use in jinja2 template &#8220;for&#8221; loops.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Some lookups pass arguments to a shell. When using variables from a remote/untrusted source, use the <cite>|quote</cite> filter to ensure safe usage.</p>
</div>
<div class="contents topic" id="topics">
<p class="topic-title first">Topics</p>
<ul class="simple">
<li><a class="reference internal" href="#lookups" id="id3">Lookups</a><ul>
<li><a class="reference internal" href="#intro-to-lookups-getting-file-contents" id="id4">Intro to Lookups: Getting File Contents</a></li>
<li><a class="reference internal" href="#the-password-lookup" id="id5">The Password Lookup</a></li>
<li><a class="reference internal" href="#the-passwordstore-lookup" id="id6">The Passwordstore Lookup</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples" id="id7">Examples</a><ul>
<li><a class="reference internal" href="#the-csv-file-lookup" id="id8">The CSV File Lookup</a></li>
<li><a class="reference internal" href="#the-ini-file-lookup" id="id9">The INI File Lookup</a></li>
<li><a class="reference internal" href="#the-credstash-lookup" id="id10">The Credstash Lookup</a></li>
<li><a class="reference internal" href="#the-dns-lookup-dig" id="id11">The DNS Lookup (dig)</a></li>
<li><a class="reference internal" href="#mongodb-lookup" id="id12">MongoDB Lookup</a></li>
<li><a class="reference internal" href="#more-lookups" id="id13">More Lookups</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="intro-to-lookups-getting-file-contents">
<span id="getting-file-contents"></span><h2><a class="toc-backref" href="#id4">Intro to Lookups: Getting File Contents</a><a class="headerlink" href="#intro-to-lookups-getting-file-contents" title="Permalink to this headline">¶</a></h2>
<p>The file lookup is the most basic lookup type.</p>
<p>Contents can be read off the filesystem as follows:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="l l-Scalar l-Scalar-Plain">vars</span><span class="p p-Indicator">:</span>
     <span class="l l-Scalar l-Scalar-Plain">contents</span><span class="p p-Indicator">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;file&#39;</span><span class="o">,</span> <span class="s1">&#39;/etc/foo.txt&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>

  <span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>

     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;the value of foo.txt is </span><span class="cp">{{</span> <span class="nv">contents</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="the-password-lookup">
<span id="password-lookup"></span><h2><a class="toc-backref" href="#id5">The Password Lookup</a><a class="headerlink" href="#the-password-lookup" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A great alternative to the password lookup plugin, if you don&#8217;t need to generate random passwords on a per-host basis, would be to use <a class="reference internal" href="playbooks_vault.html"><span class="doc">Using Vault in playbooks</span></a>.  Read the documentation there and consider using it first, it will be more desirable for most applications.</p>
</div>
<p><code class="docutils literal"><span class="pre">password</span></code> generates a random plaintext password and stores it in
a file at a given filepath.</p>
<p>(Docs about crypted save modes are pending)</p>
<p>If the file exists previously, it will retrieve its contents, behaving just like with_file. Usage of variables like &#8220;{{ inventory_hostname }}&#8221; in the filepath can be used to set
up random passwords per host (which simplifies password management in &#8216;host_vars&#8217; variables).</p>
<p>A special case is using <code class="docutils literal"><span class="pre">/dev/null</span></code> as a path. The password lookup will generate a new random password each time, but will not write it to <code class="docutils literal"><span class="pre">/dev/null</span></code>. This can be used when you need a password
without storing it on the controller.</p>
<p>Generated passwords contain a random mix of upper and lowercase ASCII letters, the
numbers 0-9 and punctuation (&#8221;. , : - _&#8221;). The default length of a generated password is 20 characters.
This length can be changed by passing an extra parameter:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">all</span>

  <span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>

    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">create a mysql user with a random password</span>
      <span class="l l-Scalar l-Scalar-Plain">mysql_user</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">client</span> <span class="cp">}}</span><span class="s">&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">password</span><span class="p p-Indicator">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;password&#39;</span><span class="o">,</span> <span class="s1">&#39;credentials/&#39;</span> <span class="o">+</span> <span class="nv">client</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nv">tier</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nv">role</span> <span class="o">+</span> <span class="s1">&#39;/mysqlpassword length=15&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">priv</span><span class="p p-Indicator">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">client</span> <span class="cp">}}</span><span class="s">_</span><span class="cp">{{</span> <span class="nv">tier</span> <span class="cp">}}</span><span class="s">_</span><span class="cp">{{</span> <span class="nv">role</span> <span class="cp">}}</span><span class="s">.*:ALL&quot;</span>

    <span class="c1"># (...)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the file already exists, no data will be written to it. If the file has contents, those contents will be read in as the password. Empty files cause the password to return as an empty string.</p>
</div>
<p>Caution: Since this runs on the ansible host as the user running the playbook, and &#8220;become&#8221; does not apply, the target file must be readable by the playbook user, or, if it does not exist, the playbook user must have sufficient privileges to create it. (So, for example, attempts to write into areas such as /etc will fail unless the entire playbook is being run as root).</p>
<p>Starting in version 1.4, password accepts a &#8220;chars&#8221; parameter to allow defining a custom character set in the generated passwords. It accepts comma separated list of names that are either string module attributes (ascii_letters,digits, etc) or are used literally:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">all</span>

  <span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>

    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">create a mysql user with a random password using only ascii letters</span>
      <span class="l l-Scalar l-Scalar-Plain">mysql_user</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">name=</span><span class="cp">{{</span> <span class="nv">client</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain"> password=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;password&#39;</span><span class="o">,</span> <span class="s1">&#39;/tmp/passwordfile chars=ascii_letters&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot; priv=</span><span class="cp">{{</span> <span class="nv">client</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">_</span><span class="cp">{{</span> <span class="nv">tier</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">_</span><span class="cp">{{</span> <span class="nv">role</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">.*:ALL</span>

    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">create a mysql user with a random password using only digits</span>
      <span class="l l-Scalar l-Scalar-Plain">mysql_user</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">client</span> <span class="cp">}}</span><span class="s">&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">password</span><span class="p p-Indicator">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;password&#39;</span><span class="o">,</span> <span class="s1">&#39;/tmp/passwordfile chars=digits&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">priv</span><span class="p p-Indicator">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">client</span> <span class="cp">}}</span><span class="s">_</span><span class="cp">{{</span> <span class="nv">tier</span> <span class="cp">}}</span><span class="s">_</span><span class="cp">{{</span> <span class="nv">role</span> <span class="cp">}}</span><span class="s">.*:ALL&quot;</span>

    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">create a mysql user with a random password using many different char sets</span>
      <span class="l l-Scalar l-Scalar-Plain">mysql_user</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">client</span> <span class="cp">}}</span><span class="s">&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">password&quot; &quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;password&#39;</span><span class="o">,</span> <span class="s1">&#39;/tmp/passwordfile chars=ascii_letters,digits,hexdigits,punctuation&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
        <span class="l l-Scalar l-Scalar-Plain">priv</span><span class="p p-Indicator">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">client</span> <span class="cp">}}</span><span class="s">_</span><span class="cp">{{</span> <span class="nv">tier</span> <span class="cp">}}</span><span class="s">_</span><span class="cp">{{</span> <span class="nv">role</span> <span class="cp">}}</span><span class="s">.*:ALL&quot;</span>

    <span class="c1"># (...)</span>
</pre></div>
</div>
<p>To enter comma use two commas &#8216;,,&#8217; somewhere - preferably at the end. Quotes and double quotes are not supported.</p>
</div>
<div class="section" id="the-passwordstore-lookup">
<span id="passwordstore-lookup"></span><h2><a class="toc-backref" href="#id6">The Passwordstore Lookup</a><a class="headerlink" href="#the-passwordstore-lookup" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
<p>The <code class="docutils literal"><span class="pre">passwordstore</span></code> lookup enables Ansible to retrieve, create or update passwords from
the <a class="reference external" href="https://www.passwordstore.org">passwordstore.org</a> <code class="docutils literal"><span class="pre">pass</span></code> utility. It also retrieves YAML style keys stored as multilines
in the passwordfile.</p>
</div>
</div>
<div class="section" id="examples">
<h1><a class="toc-backref" href="#id7">Examples</a><a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<p>Basic lookup. Fails if example/test doesn&#8217;t exist:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">password=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;passwordstore&#39;</span><span class="o">,</span> <span class="s1">&#39;example/test&#39;</span><span class="o">)</span><span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
<p>Create pass with random 16 character password. If password exists just give the password:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">password=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;passwordstore&#39;</span><span class="o">,</span> <span class="s1">&#39;example/test create=true&#39;</span><span class="o">)</span><span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
<p>Different size password:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">password=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;passwordstore&#39;</span><span class="o">,</span> <span class="s1">&#39;example/test create=true length=42&#39;</span><span class="o">)</span><span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
<p>Create password and overwrite the password if it exists. As a bonus, this module includes the old password inside the pass file:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">password=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;passwordstore&#39;</span><span class="o">,</span> <span class="s1">&#39;example/test create=true overwrite=true&#39;</span><span class="o">)</span><span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
<p>Return the value for user in the KV pair user: username:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">password=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;passwordstore&#39;</span><span class="o">,</span> <span class="s1">&#39;example/test subkey=user&#39;</span><span class="o">)</span><span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
<p>Return the entire password file content:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">password=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;passwordstore&#39;</span><span class="o">,</span> <span class="s1">&#39;example/test returnall=true&#39;</span><span class="o">)</span><span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
<dl class="docutils">
<dt>The location of the password-store directory can be specified in the following ways:</dt>
<dd><ul class="first last simple">
<li>Default is ~/.password-store</li>
<li>Can be overruled by PASSWORD_STORE_DIR environment variable</li>
<li>Can be overruled by &#8216;passwordstore: path/to/.password-store&#8217; ansible setting</li>
<li>Can be overruled by &#8216;directory=path&#8217; argument in the lookup call</li>
</ul>
</dd>
</dl>
<div class="section" id="the-csv-file-lookup">
<span id="csvfile-lookup"></span><h2><a class="toc-backref" href="#id8">The CSV File Lookup</a><a class="headerlink" href="#the-csv-file-lookup" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.5.</span></p>
</div>
<p>The <code class="docutils literal"><span class="pre">csvfile</span></code> lookup reads the contents of a file in CSV (comma-separated value)
format. The lookup looks for the row where the first column matches <code class="docutils literal"><span class="pre">keyname</span></code>, and
returns the value in the second column, unless a different column is specified.</p>
<p>The example below shows the contents of a CSV file named elements.csv with information about the
periodic table of elements:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">Symbol,Atomic Number,Atomic Mass</span>
<span class="l l-Scalar l-Scalar-Plain">H,1,1.008</span>
<span class="l l-Scalar l-Scalar-Plain">He,2,4.0026</span>
<span class="l l-Scalar l-Scalar-Plain">Li,3,6.94</span>
<span class="l l-Scalar l-Scalar-Plain">Be,4,9.012</span>
<span class="l l-Scalar l-Scalar-Plain">B,5,10.81</span>
</pre></div>
</div>
<p>We can use the <code class="docutils literal"><span class="pre">csvfile</span></code> plugin to look up the atomic number or atomic of Lithium by its symbol:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;The atomic number of Lithium is </span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;csvfile&#39;</span><span class="o">,</span> <span class="s1">&#39;Li file=elements.csv delimiter=,&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;The atomic mass of Lithium is </span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;csvfile&#39;</span><span class="o">,</span> <span class="s1">&#39;Li file=elements.csv delimiter=, col=2&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">csvfile</span></code> lookup supports several arguments. The format for passing
arguments is:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">lookup(&#39;csvfile&#39;, &#39;key arg1=val1 arg2=val2 ...&#39;)</span>
</pre></div>
</div>
<p>The first value in the argument is the <code class="docutils literal"><span class="pre">key</span></code>, which must be an entry that
appears exactly once in column 0 (the first column, 0-indexed) of the table. All other arguments are optional.</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="11%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Field</td>
<td>Default</td>
<td>Description</td>
</tr>
<tr class="row-even"><td>file</td>
<td>ansible.csv</td>
<td>Name of the file to load</td>
</tr>
<tr class="row-odd"><td>col</td>
<td>1</td>
<td>The column to output, indexed by 0</td>
</tr>
<tr class="row-even"><td>delimiter</td>
<td>TAB</td>
<td>Delimiter used by CSV file. As a special case, tab can be specified as either TAB or t.</td>
</tr>
<tr class="row-odd"><td>default</td>
<td>empty string</td>
<td>Default return value if the key is not in the csv file</td>
</tr>
<tr class="row-even"><td>encoding</td>
<td>utf-8</td>
<td>Encoding (character set) of the used CSV file (added in version 2.1)</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The default delimiter is TAB, <em>not</em> comma.</p>
</div>
</div>
<div class="section" id="the-ini-file-lookup">
<span id="ini-lookup"></span><h2><a class="toc-backref" href="#id9">The INI File Lookup</a><a class="headerlink" href="#the-ini-file-lookup" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.0.</span></p>
</div>
<p>The <code class="docutils literal"><span class="pre">ini</span></code> lookup reads the contents of a file in INI format (key1=value1).
This plugin retrieve the value on the right side after the equal sign (&#8216;=&#8217;) of
a given section ([section]). You can also read a property file which - in this
case - does not contain section.</p>
<p>Here&#8217;s a simple example of an INI file with user/password configuration:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[production]</span>
<span class="c1"># My production information</span>
<span class="na">user</span><span class="o">=</span><span class="s">robert</span>
<span class="na">pass</span><span class="o">=</span><span class="s">somerandompassword</span>

<span class="k">[integration]</span>
<span class="c1"># My integration information</span>
<span class="na">user</span><span class="o">=</span><span class="s">gertrude</span>
<span class="na">pass</span><span class="o">=</span><span class="s">anotherpassword</span>
</pre></div>
</div>
<p>We can use the <code class="docutils literal"><span class="pre">ini</span></code> plugin to lookup user configuration:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;User in integration is </span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;ini&#39;</span><span class="o">,</span> <span class="s1">&#39;user section=integration file=users.ini&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;User in production  is </span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;ini&#39;</span><span class="o">,</span> <span class="s1">&#39;user section=production  file=users.ini&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
<p>Another example for this plugin is for looking for a value on java properties.
Here&#8217;s a simple properties we&#8217;ll take as an example:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">user.name</span><span class="o">=</span><span class="s">robert</span>
<span class="na">user.pass</span><span class="o">=</span><span class="s">somerandompassword</span>
</pre></div>
</div>
<p>You can retrieve the <code class="docutils literal"><span class="pre">user.name</span></code> field with the following lookup:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;user.name is </span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;ini&#39;</span><span class="o">,</span> <span class="s1">&#39;user.name type=properties file=user.properties&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">ini</span></code> lookup supports several arguments like the csv plugin. The format for passing
arguments is:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">lookup(&#39;ini&#39;, &#39;key [type=&lt;properties|ini&gt;] [section=section] [file=file.ini] [re=true] [default=&lt;defaultvalue&gt;]&#39;)</span>
</pre></div>
</div>
<p>The first value in the argument is the <code class="docutils literal"><span class="pre">key</span></code>, which must be an entry that
appears exactly once on keys. All other arguments are optional.</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="11%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Field</td>
<td>Default</td>
<td>Description</td>
</tr>
<tr class="row-even"><td>type</td>
<td>ini</td>
<td>Type of the file. Can be ini or properties (for java properties).</td>
</tr>
<tr class="row-odd"><td>file</td>
<td>ansible.ini</td>
<td>Name of the file to load</td>
</tr>
<tr class="row-even"><td>section</td>
<td>global</td>
<td>Default section where to lookup for key.</td>
</tr>
<tr class="row-odd"><td>re</td>
<td>False</td>
<td>The key is a regexp.</td>
</tr>
<tr class="row-even"><td>encoding</td>
<td>utf-8</td>
<td>Text encoding to use.</td>
</tr>
<tr class="row-odd"><td>default</td>
<td>empty string</td>
<td>return value if the key is not in the ini file</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In java properties files, there&#8217;s no need to specify a section.</p>
</div>
</div>
<div class="section" id="the-credstash-lookup">
<span id="credstash-lookup"></span><h2><a class="toc-backref" href="#id10">The Credstash Lookup</a><a class="headerlink" href="#the-credstash-lookup" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.0.</span></p>
</div>
<p>Credstash is a small utility for managing secrets using AWS&#8217;s KMS and DynamoDB: <a class="reference external" href="https://github.com/fugue/credstash">https://github.com/fugue/credstash</a></p>
<p>First, you need to store your secrets with credstash:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span></span><span class="go">credstash put my-github-password secure123</span>

<span class="gp">#</span> my-github-password has been stored
</pre></div>
</div>
<p>Example usage:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;Test</span><span class="nv"> </span><span class="s">credstash</span><span class="nv"> </span><span class="s">lookup</span><span class="nv"> </span><span class="s">plugin</span><span class="nv"> </span><span class="s">--</span><span class="nv"> </span><span class="s">get</span><span class="nv"> </span><span class="s">my</span><span class="nv"> </span><span class="s">github</span><span class="nv"> </span><span class="s">password&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;Credstash lookup! </span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;credstash&#39;</span><span class="o">,</span> <span class="s1">&#39;my-github-password&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
<p>You can specify regions or tables to fetch secrets from:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;Test</span><span class="nv"> </span><span class="s">credstash</span><span class="nv"> </span><span class="s">lookup</span><span class="nv"> </span><span class="s">plugin</span><span class="nv"> </span><span class="s">--</span><span class="nv"> </span><span class="s">get</span><span class="nv"> </span><span class="s">my</span><span class="nv"> </span><span class="s">other</span><span class="nv"> </span><span class="s">password</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">us-west-1&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;Credstash lookup! </span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;credstash&#39;</span><span class="o">,</span> <span class="s1">&#39;my-other-password&#39;</span><span class="o">,</span> <span class="nv">region</span><span class="o">=</span><span class="s1">&#39;us-west-1&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>


<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;Test</span><span class="nv"> </span><span class="s">credstash</span><span class="nv"> </span><span class="s">lookup</span><span class="nv"> </span><span class="s">plugin</span><span class="nv"> </span><span class="s">--</span><span class="nv"> </span><span class="s">get</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">company&#39;s</span><span class="nv"> </span><span class="s">github</span><span class="nv"> </span><span class="s">password&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;Credstash lookup! </span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;credstash&#39;</span><span class="o">,</span> <span class="s1">&#39;company-github-password&#39;</span><span class="o">,</span> <span class="nv">table</span><span class="o">=</span><span class="s1">&#39;company-passwords&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
<p>If you use the context feature when putting your secret, you can get it by passing a dictionary to the context option like this:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">test</span>
  <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">localhost</span>
  <span class="l l-Scalar l-Scalar-Plain">vars</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">context</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">app</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">my_app</span>
      <span class="l l-Scalar l-Scalar-Plain">environment</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">production</span>
  <span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>

  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;Test</span><span class="nv"> </span><span class="s">credstash</span><span class="nv"> </span><span class="s">lookup</span><span class="nv"> </span><span class="s">plugin</span><span class="nv"> </span><span class="s">--</span><span class="nv"> </span><span class="s">get</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">password</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">context</span><span class="nv"> </span><span class="s">passed</span><span class="nv"> </span><span class="s">as</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">variable&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;credstash&#39;</span><span class="o">,</span> <span class="s1">&#39;some-password&#39;</span><span class="o">,</span> <span class="nv">context</span><span class="o">=</span><span class="nv">context</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>

  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="s">&quot;Test</span><span class="nv"> </span><span class="s">credstash</span><span class="nv"> </span><span class="s">lookup</span><span class="nv"> </span><span class="s">plugin</span><span class="nv"> </span><span class="s">--</span><span class="nv"> </span><span class="s">get</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">password</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">context</span><span class="nv"> </span><span class="s">defined</span><span class="nv"> </span><span class="s">here&quot;</span>
    <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;credstash&#39;</span><span class="o">,</span> <span class="s1">&#39;some-password&#39;</span><span class="o">,</span> <span class="nv">context</span><span class="o">=</span><span class="nv">dict</span><span class="o">(</span><span class="nv">app</span><span class="o">=</span><span class="s1">&#39;my_app&#39;</span><span class="o">,</span> <span class="nv">environment</span><span class="o">=</span><span class="s1">&#39;production&#39;</span><span class="o">))</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
<p>If you&#8217;re not using 2.0 yet, you can do something similar with the credstash tool and the pipe lookup (see below):</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;Poor man&#39;s credstash lookup! </span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;pipe&#39;</span><span class="o">,</span> <span class="s1">&#39;credstash -r us-west-1 get my-other-password&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="the-dns-lookup-dig">
<span id="dns-lookup"></span><h2><a class="toc-backref" href="#id11">The DNS Lookup (dig)</a><a class="headerlink" href="#the-dns-lookup-dig" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.9.0.</span></p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This lookup depends on the <a class="reference external" href="http://www.dnspython.org/">dnspython</a>
library.</p>
</div>
<p>The <code class="docutils literal"><span class="pre">dig</span></code> lookup runs queries against DNS servers to retrieve DNS records for
a specific name (<em>FQDN</em> - fully qualified domain name). It is possible to lookup any DNS record in this manner.</p>
<p>There is a couple of different syntaxes that can be used to specify what record
should be retrieved, and for which name. It is also possible to explicitly
specify the DNS server(s) to use for lookups.</p>
<p>In its simplest form, the <code class="docutils literal"><span class="pre">dig</span></code> lookup plugin can be used to retrieve an IPv4
address (DNS <code class="docutils literal"><span class="pre">A</span></code> record) associated with <em>FQDN</em>:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you need to obtain the <code class="docutils literal"><span class="pre">AAAA</span></code> record (IPv6 address), you must
specify the record type explicitly. Syntax for specifying the record
type is described below.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The trailing dot in most of the examples listed is purely optional,
but is specified for completeness/correctness sake.</p>
</div>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;The IPv4 address for example.com. is </span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;dig&#39;</span><span class="o">,</span> <span class="s1">&#39;example.com.&#39;</span><span class="o">)</span><span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
<p>In addition to (default) <code class="docutils literal"><span class="pre">A</span></code> record, it is also possible to specify a different
record type that should be queried. This can be done by either passing-in
additional parameter of format <code class="docutils literal"><span class="pre">qtype=TYPE</span></code> to the <code class="docutils literal"><span class="pre">dig</span></code> lookup, or by
appending <code class="docutils literal"><span class="pre">/TYPE</span></code> to the <em>FQDN</em> being queried. For example:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;The TXT record for example.org. is </span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;dig&#39;</span><span class="o">,</span> <span class="s1">&#39;example.org.&#39;</span><span class="o">,</span> <span class="s1">&#39;qtype=TXT&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;The TXT record for example.org. is </span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;dig&#39;</span><span class="o">,</span> <span class="s1">&#39;example.org./TXT&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
<p>If multiple values are associated with the requested record, the results will be
returned as a comma-separated list. In such cases you may want to pass option
<code class="docutils literal"><span class="pre">wantlist=True</span></code> to the plugin, which will result in the record values being
returned as a list over which you can iterate later on:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;One of the MX records for gmail.com. is </span><span class="cp">{{</span> <span class="nv">item</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">with_items</span><span class="p p-Indicator">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;dig&#39;</span><span class="o">,</span> <span class="s1">&#39;gmail.com./MX&#39;</span><span class="o">,</span> <span class="nv">wantlist</span><span class="o">=</span><span class="kp">True</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
<p>In case of reverse DNS lookups (<code class="docutils literal"><span class="pre">PTR</span></code> records), you can also use a convenience
syntax of format <code class="docutils literal"><span class="pre">IP_ADDRESS/PTR</span></code>. The following three lines would produce the
same output:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;Reverse DNS for 192.0.2.5 is </span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;dig&#39;</span><span class="o">,</span> <span class="s1">&#39;192.0.2.5/PTR&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;Reverse DNS for 192.0.2.5 is </span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;dig&#39;</span><span class="o">,</span> <span class="s1">&#39;5.2.0.192.in-addr.arpa./PTR&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;Reverse DNS for 192.0.2.5 is </span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;dig&#39;</span><span class="o">,</span> <span class="s1">&#39;5.2.0.192.in-addr.arpa.&#39;</span><span class="o">,</span> <span class="s1">&#39;qtype=PTR&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
<p>By default, the lookup will rely on system-wide configured DNS servers for
performing the query. It is also possible to explicitly specify DNS servers to
query using the <code class="docutils literal"><span class="pre">&#64;DNS_SERVER_1,DNS_SERVER_2,...,DNS_SERVER_N</span></code> notation. This
needs to be passed-in as an additional parameter to the lookup. For example:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;Querying 198.51.100.23 for IPv4 address for example.com. produces </span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;dig&#39;</span><span class="o">,</span> <span class="s1">&#39;example.com&#39;</span><span class="o">,</span> <span class="s1">&#39;@198.51.100.23&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
<p>In some cases the DNS records may hold a more complex data structure, or it may
be useful to obtain the results in a form of a dictionary for future
processing. The <code class="docutils literal"><span class="pre">dig</span></code> lookup supports parsing of a number of such records,
with the result being returned as a dictionary. This way it is possible to
easily access such nested data. This return format can be requested by
passing-in the <code class="docutils literal"><span class="pre">flat=0</span></code> option to the lookup. For example:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;XMPP service for gmail.com. is available at </span><span class="cp">{{</span> <span class="nv">item.target</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain"> on port </span><span class="cp">{{</span> <span class="nv">item.port</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
  <span class="l l-Scalar l-Scalar-Plain">with_items</span><span class="p p-Indicator">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;dig&#39;</span><span class="o">,</span> <span class="s1">&#39;_xmpp-server._tcp.gmail.com./SRV&#39;</span><span class="o">,</span> <span class="s1">&#39;flat=0&#39;</span><span class="o">,</span> <span class="nv">wantlist</span><span class="o">=</span><span class="kp">True</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
<p>Take note that due to the way Ansible lookups work, you must pass the
<code class="docutils literal"><span class="pre">wantlist=True</span></code> argument to the lookup, otherwise Ansible will report errors.</p>
<p>Currently the dictionary results are supported for the following records:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><em>ALL</em> is not a record per-se, merely the listed fields are available
for any record results you retrieve in the form of a dictionary.</p>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Record</td>
<td>Fields</td>
</tr>
<tr class="row-even"><td><em>ALL</em></td>
<td>owner, ttl, type</td>
</tr>
<tr class="row-odd"><td>A</td>
<td>address</td>
</tr>
<tr class="row-even"><td>AAAA</td>
<td>address</td>
</tr>
<tr class="row-odd"><td>CNAME</td>
<td>target</td>
</tr>
<tr class="row-even"><td>DNAME</td>
<td>target</td>
</tr>
<tr class="row-odd"><td>DLV</td>
<td>algorithm, digest_type, key_tag, digest</td>
</tr>
<tr class="row-even"><td>DNSKEY</td>
<td>flags, algorithm, protocol, key</td>
</tr>
<tr class="row-odd"><td>DS</td>
<td>algorithm, digest_type, key_tag, digest</td>
</tr>
<tr class="row-even"><td>HINFO</td>
<td>cpu, os</td>
</tr>
<tr class="row-odd"><td>LOC</td>
<td>latitude, longitude, altitude, size, horizontal_precision, vertical_precision</td>
</tr>
<tr class="row-even"><td>MX</td>
<td>preference, exchange</td>
</tr>
<tr class="row-odd"><td>NAPTR</td>
<td>order, preference, flags, service, regexp, replacement</td>
</tr>
<tr class="row-even"><td>NS</td>
<td>target</td>
</tr>
<tr class="row-odd"><td>NSEC3PARAM</td>
<td>algorithm, flags, iterations, salt</td>
</tr>
<tr class="row-even"><td>PTR</td>
<td>target</td>
</tr>
<tr class="row-odd"><td>RP</td>
<td>mbox, txt</td>
</tr>
<tr class="row-even"><td>SOA</td>
<td>mname, rname, serial, refresh, retry, expire, minimum</td>
</tr>
<tr class="row-odd"><td>SPF</td>
<td>strings</td>
</tr>
<tr class="row-even"><td>SRV</td>
<td>priority, weight, port, target</td>
</tr>
<tr class="row-odd"><td>SSHFP</td>
<td>algorithm, fp_type, fingerprint</td>
</tr>
<tr class="row-even"><td>TLSA</td>
<td>usage, selector, mtype, cert</td>
</tr>
<tr class="row-odd"><td>TXT</td>
<td>strings</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mongodb-lookup">
<span id="id1"></span><h2><a class="toc-backref" href="#id12">MongoDB Lookup</a><a class="headerlink" href="#mongodb-lookup" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.3.</span></p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This lookup depends on the <a class="reference external" href="http://www.mongodb.org/">pymongo 2.4+</a>
library.</p>
</div>
<p>The <code class="docutils literal"><span class="pre">MongoDB</span></code> lookup runs the <em>find()</em> command on a given <em>collection</em> on a given <em>MongoDB</em> server.</p>
<p>The result is a list of jsons, so slightly different from what PyMongo returns. In particular, <em>timestamps</em> are converted to epoch integers.</p>
<p>Currently, the following parameters are supported.</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="3%" />
<col width="3%" />
<col width="8%" />
<col width="76%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Parameter</td>
<td>Mandatory</td>
<td>Type</td>
<td>Default Value</td>
<td>Comment</td>
</tr>
<tr class="row-even"><td>connection_string</td>
<td>no</td>
<td>string</td>
<td>mongodb://localhost/</td>
<td>Can be any valid MongoDB connection string, supporting authentication, replicasets, etc. More info at <a class="reference external" href="https://docs.mongodb.org/manual/reference/connection-string/">https://docs.mongodb.org/manual/reference/connection-string/</a></td>
</tr>
<tr class="row-odd"><td>extra_connection_parameters</td>
<td>no</td>
<td>dict</td>
<td>{}</td>
<td>Dictionary with extra parameters like ssl, ssl_keyfile, maxPoolSize etc... Check the full list here: <a class="reference external" href="https://api.mongodb.org/python/current/api/pymongo/mongo_client.html#pymongo.mongo_client.MongoClient">https://api.mongodb.org/python/current/api/pymongo/mongo_client.html#pymongo.mongo_client.MongoClient</a></td>
</tr>
<tr class="row-even"><td>database</td>
<td>yes</td>
<td>string</td>
<td>&#160;</td>
<td>Name of the database which the query will be made</td>
</tr>
<tr class="row-odd"><td>collection</td>
<td>yes</td>
<td>string</td>
<td>&#160;</td>
<td>Name of the collection which the query will be made</td>
</tr>
<tr class="row-even"><td>filter</td>
<td>no</td>
<td>dict</td>
<td>[pymongo default]</td>
<td>Criteria of the output Example: { &#8220;hostname&#8221;: &#8220;batman&#8221; }</td>
</tr>
<tr class="row-odd"><td>projection</td>
<td>no</td>
<td>dict</td>
<td>[pymongo default]</td>
<td>Fields you want returned. Example: { &#8220;pid&#8221;: True    , &#8220;_id&#8221; : False , &#8220;hostname&#8221; : True }</td>
</tr>
<tr class="row-even"><td>skip</td>
<td>no</td>
<td>integer</td>
<td>[pymongo default]</td>
<td>How many results should be skept</td>
</tr>
<tr class="row-odd"><td>limit</td>
<td>no</td>
<td>integer</td>
<td>[pymongo default]</td>
<td>How many results should be shown</td>
</tr>
<tr class="row-even"><td>sort</td>
<td>no</td>
<td>list</td>
<td>[pymongo default]</td>
<td>Sorting rules. Please notice the constats are replaced by strings. [ [ &#8220;startTime&#8221; , &#8220;ASCENDING&#8221; ] , [ &#8220;age&#8221;, &#8220;DESCENDING&#8221; ] ]</td>
</tr>
<tr class="row-odd"><td>[any find() parameter]</td>
<td>no</td>
<td>[any]</td>
<td>[pymongo default]</td>
<td>Every parameter with exception to <em>connection_string</em>, <em>database</em> and <em>collection</em> are passed to pymongo directly.</td>
</tr>
</tbody>
</table>
<p>Please check <a class="reference external" href="https://api.mongodb.org/python/current/api/pymongo/collection.html?highlight=find#pymongo.collection.Collection.find">https://api.mongodb.org/python/current/api/pymongo/collection.html?highlight=find#pymongo.collection.Collection.find</a> for more detais.</p>
<p>Since there are too many parameters for this lookup method, below is a sample playbook which shows its usage and a nice way to feed the parameters:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">all</span>
  <span class="l l-Scalar l-Scalar-Plain">gather_facts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>

  <span class="l l-Scalar l-Scalar-Plain">vars</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">mongodb_parameters</span><span class="p p-Indicator">:</span>
      <span class="c1">#optional parameter, default = &quot;mongodb://localhost/&quot;</span>
      <span class="c1"># connection_string: &quot;mongodb://localhost/&quot;</span>
      <span class="c1"># extra_connection_parameters: { &quot;ssl&quot; : True , &quot;ssl_certfile&quot;: /etc/self_signed_certificate.pem&quot; }</span>

      <span class="c1">#mandatory parameters</span>
      <span class="l l-Scalar l-Scalar-Plain">database</span><span class="p p-Indicator">:</span> <span class="s">&#39;local&#39;</span>
      <span class="l l-Scalar l-Scalar-Plain">collection</span><span class="p p-Indicator">:</span> <span class="s">&quot;startup_log&quot;</span>

      <span class="c1">#optional query  parameters</span>
      <span class="c1">#we accept any parameter from the normal mongodb query.</span>
      <span class="c1"># the official documentation is here</span>
      <span class="c1"># https://api.mongodb.org/python/current/api/pymongo/collection.html?highlight=find#pymongo.collection.Collection.find</span>
      <span class="c1"># filter:  { &quot;hostname&quot;: &quot;batman&quot; }</span>
      <span class="l l-Scalar l-Scalar-Plain">projection</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span> <span class="s">&quot;pid&quot;</span><span class="p p-Indicator">:</span> <span class="nv">True</span>    <span class="p p-Indicator">,</span> <span class="s">&quot;_id&quot;</span> <span class="p p-Indicator">:</span> <span class="nv">False</span> <span class="p p-Indicator">,</span> <span class="s">&quot;hostname&quot;</span> <span class="p p-Indicator">:</span> <span class="nv">True</span> <span class="p p-Indicator">}</span>
      <span class="c1"># skip: 0</span>
      <span class="l l-Scalar l-Scalar-Plain">limit</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
      <span class="c1"># sort:  [ [ &quot;startTime&quot; , &quot;ASCENDING&quot; ] , [ &quot;age&quot;, &quot;DESCENDING&quot; ] ]</span>

  <span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;Mongo has already started with the following PID [{{ item.pid }}]&quot;</span>
      <span class="l l-Scalar l-Scalar-Plain">with_mongodb</span><span class="p p-Indicator">:</span> <span class="s">&quot;{{mongodb_parameters}}&quot;</span>
</pre></div>
</div>
<p>Sample output:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span></span><span class="gp"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="89e4ede0ecf3c9ebe8fde4e8e7">[email&#160;protected]</a>:~/ansible$</span> ansible-playbook m.yml -i localhost.ini

<span class="go">PLAY [all] *********************************************************************</span>

<span class="go">TASK [debug] *******************************************************************</span>
<span class="go">Sunday 20 March 2016  22:40:39 +0200 (0:00:00.023)       0:00:00.023 **********</span>
<span class="go">ok: [localhost] =&gt; (item={u&#39;hostname&#39;: u&#39;batman&#39;, u&#39;pid&#39;: 60639L}) =&gt; {</span>
<span class="go">    &quot;item&quot;: {</span>
<span class="go">        &quot;hostname&quot;: &quot;batman&quot;,</span>
<span class="go">        &quot;pid&quot;: 60639</span>
<span class="go">    },</span>
<span class="go">    &quot;msg&quot;: &quot;Mongo has already started with the following PID [60639]&quot;</span>
<span class="go">}</span>

<span class="go">PLAY RECAP *********************************************************************</span>
<span class="go">localhost                  : ok=1    changed=0    unreachable=0    failed=0</span>

<span class="go">Sunday 20 March 2016  22:40:39 +0200 (0:00:00.067)       0:00:00.091 **********</span>
<span class="go">===============================================================================</span>
<span class="go">debug ------------------------------------------------------------------- 0.07s</span>
<span class="gp"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a6cbc2cfc3dce6c4c7d2cbc7c8">[email&#160;protected]</a>:~/ansible$</span>
</pre></div>
</div>
</div>
<div class="section" id="more-lookups">
<span id="id2"></span><h2><a class="toc-backref" href="#id13">More Lookups</a><a class="headerlink" href="#more-lookups" title="Permalink to this headline">¶</a></h2>
<p>Various <em>lookup plugins</em> allow additional ways to iterate over data.  In <a class="reference internal" href="playbooks_loops.html"><span class="doc">Loops</span></a> you will learn
how to use them to walk over collections of numerous types.  However, they can also be used to pull in data
from remote sources, such as shell commands or even key value stores. This section will cover lookup plugins in this capacity.</p>
<p>Here are some examples:</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">hosts</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">all</span>

  <span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>

     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;env&#39;</span><span class="o">,</span><span class="s1">&#39;HOME&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain"> is an environment variable&quot;</span>

     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">lines will iterate over each line from stdout of a command</span>
       <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;</span><span class="cp">{{</span> <span class="nv">item</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain"> is a line from the result of this command&quot;</span>
       <span class="l l-Scalar l-Scalar-Plain">with_lines</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">cat /etc/motd</span>

     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;pipe&#39;</span><span class="o">,</span><span class="s1">&#39;date&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain"> is the raw result of running this command&quot;</span>

     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Always use quote filter to make sure your variables are safe to use with shell</span>
       <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;pipe&#39;</span><span class="o">,</span><span class="s1">&#39;getent &#39;</span> <span class="o">+</span> <span class="nv">myuser</span><span class="o">|</span><span class="nf">quote</span> <span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>

     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Quote variables with_lines also as it executes shell</span>
       <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;</span><span class="cp">{{</span> <span class="nv">item</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain"> is a line from myfile&quot;</span>
       <span class="l l-Scalar l-Scalar-Plain">with_lines</span><span class="p p-Indicator">:</span> <span class="s">&quot;cat</span><span class="nv"> </span><span class="cp">{{</span><span class="nv">myfile</span><span class="o">|</span><span class="nf">quote</span><span class="cp">}}</span><span class="s">&quot;</span>

     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">redis_kv lookup requires the Python redis package</span>
       <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;redis_kv&#39;</span><span class="o">,</span> <span class="s1">&#39;redis://localhost:6379,somekey&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain"> is value in Redis for somekey&quot;</span>

     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">dnstxt lookup requires the Python dnspython package</span>
       <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;dnstxt&#39;</span><span class="o">,</span> <span class="s1">&#39;example.com&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain"> is a DNS TXT record for example.com&quot;</span>

     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;template&#39;</span><span class="o">,</span> <span class="s1">&#39;./some_template.j2&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain"> is a value from evaluation of this template&quot;</span>

     <span class="c1"># Since 2.4, you can pass in variables during evaluation</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;template&#39;</span><span class="o">,</span> <span class="s1">&#39;./some_template.j2&#39;</span><span class="o">,</span> <span class="nv">template_vars</span><span class="o">=</span><span class="nv">dict</span><span class="o">(</span><span class="nv">x</span><span class="o">=</span><span class="m">42</span><span class="o">))</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain"> is evaluated with x=42&quot;</span>

     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">loading a json file from a template as a string</span>
       <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;template&#39;</span><span class="o">,</span> <span class="s1">&#39;./some_json.json.j2&#39;</span><span class="o">,</span> <span class="nv">convert_data</span><span class="o">=</span><span class="kp">False</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain"> is a value from evaluation of this template&quot;</span>


     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;etcd&#39;</span><span class="o">,</span> <span class="s1">&#39;foo&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain"> is a value from a locally running etcd&quot;</span>

     <span class="c1"># shelvefile lookup retrieves a string value corresponding to a key inside a Python shelve file</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;shelvefile&#39;</span><span class="o">,</span> <span class="s1">&#39;file=path_to_some_shelve_file.db key=key_to_retrieve&#39;</span><span class="o">)</span> <span class="cp">}}</span>

     <span class="c1"># The following lookups were added in 1.9</span>
     <span class="c1"># url lookup splits lines by default, an option to disable this was added in 2.4</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;</span><span class="cp">{{</span><span class="nv">item</span><span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
       <span class="l l-Scalar l-Scalar-Plain">with_url</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="s">&#39;https://github.com/gremlin.keys&#39;</span>

     <span class="c1"># outputs the cartesian product of the supplied lists</span>
     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;</span><span class="cp">{{</span><span class="nv">item</span><span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
       <span class="l l-Scalar l-Scalar-Plain">with_cartesian</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="s">&quot;</span><span class="cp">{{</span><span class="nv">list1</span><span class="cp">}}</span><span class="s">&quot;</span>
            <span class="p p-Indicator">-</span> <span class="s">&quot;</span><span class="cp">{{</span><span class="nv">list2</span><span class="cp">}}</span><span class="s">&quot;</span>
            <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="nv">4</span><span class="p p-Indicator">,</span><span class="nv">5</span><span class="p p-Indicator">,</span><span class="nv">6</span><span class="p p-Indicator">]</span>

     <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Added in 2.3 allows using the system&#39;s keyring</span>
       <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=</span><span class="cp">{{</span><span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;keyring&#39;</span><span class="o">,</span><span class="s1">&#39;myservice myuser&#39;</span><span class="o">)</span><span class="cp">}}</span>
</pre></div>
</div>
<p>As an alternative, you can also assign lookup plugins to variables or use them elsewhere.
These macros are evaluated each time they are used in a task (or template):</p>
<div class="highlight-YAML+Jinja"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">vars</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">motd_value</span><span class="p p-Indicator">:</span> <span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;file&#39;</span><span class="o">,</span> <span class="s1">&#39;/etc/motd&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>

<span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>

  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">debug</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">msg=&quot;motd value is </span><span class="cp">{{</span> <span class="nv">motd_value</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="playbooks.html"><span class="doc">Playbooks</span></a></dt>
<dd>An introduction to playbooks</dd>
<dt><a class="reference internal" href="playbooks_conditionals.html"><span class="doc">Conditionals</span></a></dt>
<dd>Conditional statements in playbooks</dd>
<dt><a class="reference internal" href="playbooks_variables.html"><span class="doc">Variables</span></a></dt>
<dd>All about variables</dd>
<dt><a class="reference internal" href="playbooks_loops.html"><span class="doc">Loops</span></a></dt>
<dd>Looping in playbooks</dd>
<dt><a class="reference external" href="http://groups.google.com/group/ansible-devel">User Mailing List</a></dt>
<dd>Have a question?  Stop by the google group!</dd>
<dt><a class="reference external" href="http://irc.freenode.net">irc.freenode.net</a></dt>
<dd>#ansible IRC chat channel</dd>
</dl>
</div>
</div>
</div>


          </div>
          <div id="search-results"><gcse:searchresults-only></div>
          <footer>
  
    <div class="rst-footer-buttons">
      
        <a href="playbooks_python_version.html" class="btn btn-neutral float-right" title="Python Version and Templating"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="playbooks_tests.html" class="btn btn-neutral" title="Tests"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

<script data-cfasync="false" src="/cdn-cgi/scripts/d07b1474/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','yABGvz2N8PwcwBxyfzUc','2.0.0');
</script>

  <p>
  Copyright © 2017 Red Hat, Inc.
  <br>
    Last updated on Oct 10, 2017.
  </p>
<p>
Ansible docs are generated from <a href="https://github.com/ansible/ansible">GitHub sources</a> using <a href="http://sphinx-doc.org/">Sphinx</a> using a theme provided by <a href="http://readthedocs.org">Read the Docs</a>. 
</p>
</footer>
        </div>
      </div>

    </section>

  </div>
  


<!-- begin analytics -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "standard-page"]);
        (function(d,s,i,r) {
        if (d.getElementById(i)){return;}
        var n = d.createElement(s),e = document.getElementsByTagName(s)[0];
        n.id=i;n.src = '//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/330046.js';
        e.parentNode.insertBefore(n, e);
        })(document, "script", "hs-analytics",300000);
</script>
<!-- end analytics -->
<script type="text/javascript">
if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
_satellite.pageBottom();
}
</script>
</body>
</html>