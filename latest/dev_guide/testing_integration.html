<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Integration tests &mdash; Ansible Documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/ansible.css" type="text/css" />
      <link rel="stylesheet" href="../_static/antsibull-minimal.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/rtd-ethical-ads.css" type="text/css" />
    <link rel="shortcut icon" href="_static/images/Ansible-Mark-RGB_Black.svg"/>
    <link rel="canonical" href="https://docs.ansible.com/ansible/latest/dev_guide/testing_integration.html"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /><!-- extra head elements for Ansible beyond RTD Sphinx Theme -->
<script src="https://www.redhat.com/dtm.js"></script>


<!-- <meta class="swiftype" name="published_at" data-type="date" content="2017-12-13" /> -->
<meta class="swiftype" name="version" data-type="string" content="6">

<!-- Google Tag Manager Data Layer -->
<script>
 dataLayer = [];
</script>
<!-- End Google Tag Manager Data Layer -->



<script>
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','https://s.swiftypecdn.com/install/v2/st.js','_st');

_st('install','yABGvz2N8PwcwBxyfzUc','2.0.0');
</script>

</head>

<body class="wy-body-for-nav"><!-- extra body elements for Ansible beyond RTD Sphinx Theme -->
<!-- Google Tag Manager -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PSB293" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-PSB293');</script>
<!-- End Google Tag Manager -->

<div class="DocSite-globalNav ansibleNav">
  <ul>
    <li><a href="https://www.ansible.com/ansiblefest" target="_blank">AnsibleFest</a></li>
    <li><a href="https://www.ansible.com/tower" target="_blank">Products</a></li>
    <li><a href="https://www.ansible.com/community" target="_blank">Community</a></li>
    <li><a href="https://www.ansible.com/webinars-training" target="_blank">Webinars & Training</a></li>
    <li><a href="https://www.ansible.com/blog" target="_blank">Blog</a></li>
  </ul>
</div>

<a class="DocSite-nav" href="/" style="padding-bottom: 30px;">

  <img class="DocSiteNav-logo"
    src="../_static/images/Ansible-Mark-RGB_White.svg"
    alt="Ansible Logo">
  <div class="DocSiteNav-title">Documentation</div>
</a>
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Ansible
          </a>
              <div class="version">
                6
              </div><!--- Based on https://github.com/rtfd/sphinx_rtd_theme/pull/438/files -->

<div class="version">
  
    <div class="version-dropdown">
      <script>
        function switchVersionTo(slug) {
          var current_url_path = window.location.pathname;
          var url_version = current_url_path.search("/6/") > -1
            ? "/6/"
            : "/latest/";
          var new_version_url = current_url_path.replace(url_version, "/" + slug + "/");
          window.location.replace(new_version_url);
        }
      </script>
      <select
          class="version-list"
          id="version-list"
          onchange="switchVersionTo(this.value);"
      >
        
        <option
            value="latest"
            
        >
            latest
        </option>
        
        <option
            value="2.9"
            
        >
            2.9
        </option>
        
        <option
            value="devel"
            
        >
            devel
        </option>
        
      </select>
    </div>
  
</div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" method="get">
    <input type="text" class="st-default-search-input" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
              <p class="caption" role="heading"><span class="caption-text">Ansible getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting started with Ansible</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation, Upgrade &amp; Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation_guide/index.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../porting_guides/porting_guides.html">Ansible Porting Guides</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/index.html">User Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../community/index.html">Ansible Community Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community/contributions_collections.html">Ansible Collections Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community/contributions.html">ansible-core Contributors Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community/advanced_index.html">Advanced Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="style_guide/index.html">Ansible documentation style guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extending Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Developer Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Common Ansible Scenarios</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scenario_guides/cloud_guides.html">Legacy Public Cloud Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scenario_guides/network_guides.html">Network Technology Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scenario_guides/virt_guides.html">Virtualization and Containerization Guides</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Network Automation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../network/getting_started/index.html">Network Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/user_guide/index.html">Network Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/dev_guide/index.html">Network Developer Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Ansible Galaxy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../galaxy/user_guide.html">Galaxy User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../galaxy/dev_guide.html">Galaxy Developer Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference &amp; Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../collections/index.html">Collection Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../collections/all_plugins.html">Indexes of all modules and plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/playbooks_keywords.html">Playbook Keywords</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/common_return_values.html">Return Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/config.html">Ansible Configuration Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/general_precedence.html">Controlling how Ansible behaves: precedence rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/YAMLSyntax.html">YAML Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/python_3_support.html">Python 3 Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/interpreter_discovery.html">Interpreter Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/release_and_maintenance.html">Releases and maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/test_strategies.html">Testing Strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing/sanity/index.html">Sanity Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/module_utils.html">Ansible Reference: Module Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/special_variables.html">Special Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/tower.html">Red Hat Ansible Automation Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/automationhub.html">Ansible Automation Hub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/logging.html">Logging Ansible output</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Roadmaps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../roadmap/ansible_roadmap_index.html">Ansible Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap/ansible_core_roadmap_index.html">ansible-core Roadmaps</a></li>
</ul>
<!-- extra nav elements for Ansible beyond RTD Sphinx Theme -->
<!-- changeable widget links to tower - do not change as image controlled by Ansible-->
<div id="sideBanner">
  <br/>
  <a href="https://www.ansible.com/docs-left?utm_source=docs">
    <img style="border-width:0px;" src="https://cdn2.hubspot.net/hubfs/330046/docs-graphics/ASB-docs-left-rail.png" />
  </a>
  <br/><br/><br/>
</div>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Ansible</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Integration tests</li>
  <li class="wy-breadcrumbs-aside">
          <!-- Ansible-specific additions for modules etc -->
            
              <a href="https://github.com/ansible/ansible/edit/devel/docs/docsite/rst/dev_guide/testing_integration.rst?description=%23%23%23%23%23%20SUMMARY%0A%3C!---%20Your%20description%20here%20--%3E%0A%0A%0A%23%23%23%23%23%20ISSUE%20TYPE%0A-%20Docs%20Pull%20Request%0A%0A%2Blabel:%20docsite_pr" class="fa fa-github"> Edit on GitHub</a>
            
  </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  <script>
    function startsWith(str, needle) {
      return str.slice(0, needle.length) == needle
    }
    function startsWithOneOf(str, needles) {
      return needles.some(function (needle) {
        return startsWith(str, needle);
      });
    }
    var banner = '';
      var extra_banner = '';
    /*use extra_banner for when marketing wants something extra, like a survey or AnsibleFest notice
    var extra_banner =
      '<div id="latest_extra_banner_id" class="admonition important">' +
      '<br>' +
      '<p>' +
        'You\'re invited to AnsibleFest 2021! ' +
      '<p>' +
        'Explore ways to automate, innovate, and accelerate with our free virtual event September 29-30. ' +
      '<pr>' +
        '<a href="https://reg.ansiblefest.redhat.com/flow/redhat/ansible21/regGenAttendee/login?sc_cid=7013a000002pemAAAQ">Register now!</a> ' +
      '</p>' +
      '<br>' +
      '</div>'; */
    // Create a banner if we're not on the official docs site
    if (location.host == "docs.testing.ansible.com") {
      document.write('<div id="testing_banner_id" class="admonition important">' +
                     '<p>This is the testing site for Ansible Documentation. Unless you are reviewing pre-production changes, please visit the <a href="https://docs.ansible.com/ansible/latest/">official documentation website</a>.</p> <p></p>' +
                     '</div>');
    }
    
      // Create a banner
      current_url_path = window.location.pathname;

      var important = false;
      var msg = '<p>';
      if (startsWith(current_url_path, "/ansible-core/")) {
        msg += 'You are reading documentation for Ansible Core, which contains no plugins except for those in ansible.builtin. For documentation of the Ansible package, go to <a href="/ansible/latest">the latest documentation</a>.';
      } else if (startsWithOneOf(current_url_path, ["/ansible/latest/", "/ansible/6/"])) {
        /* temp extra banner to advertise AnsibeFest2021 */
        banner += extra_banner;

        msg += 'You are reading the <b>latest</b> (stable) community version of the Ansible documentation. Red Hat subscribers, select <b>2.9</b> in the version selection to the left for the most recent Red Hat release.';
      } else if (startsWith(current_url_path, "/ansible/2.9/")) {
        msg += 'You are reading the latest Red Hat released version of the Ansible documentation. Community users can use this version, or select <b>latest</b> from the version selector to the left for the most recent community version.';
      } else if (startsWith(current_url_path, "/ansible/devel/")) {
        /* temp extra banner to advertise AnsibleFest2021 */
        banner += extra_banner;

        /* temp banner to advertise survey
        important = true;
        msg += 'Please take our <a href="https://www.surveymonkey.co.uk/r/B9V3CDY">Docs survey</a> before December 31 to help us improve Ansible documentation.';
        */

        msg += 'You are reading the <b>devel</b> version of the Ansible documentation - this version is not guaranteed stable. Use the version selection to the left if you want the <b>latest</b> (stable) released version.';
      } else {
        msg += 'You are reading an older version of the Ansible documentation. Use the version selection to the left if you want the <b>latest</b> (stable) released version.';
      }
      msg += '</p>';

      banner += '<div id="banner_id" class="admonition ';
      banner += important ? 'important' : 'caution';
      banner += '">';
      banner += important ? '<br>' : '';
      banner += msg;
      banner += important ? '<br>' : '';
      banner += '</div>';
      document.write(banner);
    
  </script>


  
           <div itemprop="articleBody">
             
  <section id="integration-tests">
<span id="testing-integration"></span><h1><a class="toc-backref" href="#id1">Integration tests</a><a class="headerlink" href="#integration-tests" title="Permalink to this headline"></a></h1>
<div class="contents topic" id="topics">
<p class="topic-title">Topics</p>
<ul class="simple">
<li><p><a class="reference internal" href="#integration-tests" id="id1">Integration tests</a></p>
<ul>
<li><p><a class="reference internal" href="#quick-start" id="id2">Quick Start</a></p></li>
<li><p><a class="reference internal" href="#configuration" id="id3">Configuration</a></p>
<ul>
<li><p><a class="reference internal" href="#ansible-test-command" id="id4">ansible-test command</a></p></li>
<li><p><a class="reference internal" href="#integration-config-yml" id="id5">integration_config.yml</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#prerequisites" id="id6">Prerequisites</a></p></li>
<li><p><a class="reference internal" href="#non-destructive-tests" id="id7">Non-destructive Tests</a></p></li>
<li><p><a class="reference internal" href="#destructive-tests" id="id8">Destructive Tests</a></p></li>
<li><p><a class="reference internal" href="#windows-tests" id="id9">Windows Tests</a></p></li>
<li><p><a class="reference internal" href="#tests-in-containers" id="id10">Tests in containers</a></p>
<ul>
<li><p><a class="reference internal" href="#running-integration-tests" id="id11">Running Integration Tests</a></p></li>
<li><p><a class="reference internal" href="#container-images" id="id12">Container Images</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#legacy-cloud-tests" id="id13">Legacy Cloud Tests</a></p></li>
<li><p><a class="reference internal" href="#other-configuration-for-cloud-tests" id="id14">Other configuration for Cloud Tests</a></p></li>
<li><p><a class="reference internal" href="#iam-policies-for-aws" id="id15">IAM policies for AWS</a></p>
<ul>
<li><p><a class="reference internal" href="#testing-policies" id="id16">testing-policies</a></p></li>
<li><p><a class="reference internal" href="#other-definitions-required" id="id17">Other Definitions required</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#network-tests" id="id18">Network Tests</a></p></li>
<li><p><a class="reference internal" href="#where-to-find-out-more" id="id19">Where to find out more</a></p></li>
</ul>
</li>
</ul>
</div>
<p>The Ansible integration Test system.</p>
<p>Tests for playbooks, by playbooks.</p>
<p>Some tests may require credentials.  Credentials may be specified with <cite>credentials.yml</cite>.</p>
<p>Some tests may require root.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Every new module and plugin should have integration tests, even if the tests cannot be run on Ansible CI infrastructure.
In this case, the tests should be marked with the <code class="docutils literal notranslate"><span class="pre">unsupported</span></code> alias in <a class="reference external" href="https://docs.ansible.com/ansible/latest/dev_guide/testing/sanity/integration-aliases.html">aliases file</a>.</p>
</div>
<section id="quick-start">
<h2><a class="toc-backref" href="#id2">Quick Start</a><a class="headerlink" href="#quick-start" title="Permalink to this headline"></a></h2>
<p>It is highly recommended that you install and activate the <code class="docutils literal notranslate"><span class="pre">argcomplete</span></code> python package.
It provides tab completion in <code class="docutils literal notranslate"><span class="pre">bash</span></code> for the <code class="docutils literal notranslate"><span class="pre">ansible-test</span></code> test runner.</p>
</section>
<section id="configuration">
<h2><a class="toc-backref" href="#id3">Configuration</a><a class="headerlink" href="#configuration" title="Permalink to this headline"></a></h2>
<section id="ansible-test-command">
<h3><a class="toc-backref" href="#id4">ansible-test command</a><a class="headerlink" href="#ansible-test-command" title="Permalink to this headline"></a></h3>
<p>The example below assumes <code class="docutils literal notranslate"><span class="pre">bin/</span></code> is in your <code class="docutils literal notranslate"><span class="pre">$PATH</span></code>. An easy way to achieve that
is to initialize your environment with the <code class="docutils literal notranslate"><span class="pre">env-setup</span></code> command:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">source hacking/env-setup</span>
<span class="go">ansible-test --help</span>
</pre></div>
</div>
<p>You can also call <code class="docutils literal notranslate"><span class="pre">ansible-test</span></code> with the full path:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">bin/ansible-test --help</span>
</pre></div>
</div>
</section>
<section id="integration-config-yml">
<h3><a class="toc-backref" href="#id5">integration_config.yml</a><a class="headerlink" href="#integration-config-yml" title="Permalink to this headline"></a></h3>
<p>Making your own version of <code class="docutils literal notranslate"><span class="pre">integration_config.yml</span></code> can allow for setting some
tunable parameters to help run the tests better in your environment.  Some
tests (for example, cloud tests) will only run when access credentials are provided.  For more
information about supported credentials, refer to the various <code class="docutils literal notranslate"><span class="pre">cloud-config-*.template</span></code>
files in the <code class="docutils literal notranslate"><span class="pre">test/integration/</span></code> directory.</p>
</section>
</section>
<section id="prerequisites">
<h2><a class="toc-backref" href="#id6">Prerequisites</a><a class="headerlink" href="#prerequisites" title="Permalink to this headline"></a></h2>
<p>Some tests assume things like hg, svn, and git are installed, and in path.  Some tests
(such as those for Amazon Web Services) need separate definitions, which will be covered
later in this document.</p>
<p>(Complete list pending)</p>
</section>
<section id="non-destructive-tests">
<h2><a class="toc-backref" href="#id7">Non-destructive Tests</a><a class="headerlink" href="#non-destructive-tests" title="Permalink to this headline"></a></h2>
<p>These tests will modify files in subdirectories, but will not do things that install or remove packages or things
outside of those test subdirectories.  They will also not reconfigure or bounce system services.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Running integration tests within containers</p>
<p>To protect your system from any potential changes caused by integration tests, and to ensure a sensible set of dependencies are available we recommend that you always run integration tests with the <code class="docutils literal notranslate"><span class="pre">--docker</span></code> option, for example <code class="docutils literal notranslate"><span class="pre">--docker</span> <span class="pre">ubuntu2004</span></code>. See the <a class="reference external" href="https://github.com/ansible/ansible/blob/devel/test/lib/ansible_test/_data/completion/docker.txt">list of supported container images</a> for options (the <code class="docutils literal notranslate"><span class="pre">default</span></code> image is used for sanity and unit tests, as well as for platform independent integration tests such as those for cloud modules).</p>
</div>
<p>Run as follows for all POSIX platform tests executed by our CI system in a Fedora 34 container:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">ansible-test integration shippable/ --docker fedora34</span>
</pre></div>
</div>
<p>You can target a specific tests as well, such as for individual modules:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">ansible-test integration ping</span>
</pre></div>
</div>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">-v</span></code> option to make the output more verbose:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">ansible-test integration lineinfile -vvv</span>
</pre></div>
</div>
<p>Use the following command to list all the available targets:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">ansible-test integration --list-targets</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Bash users</p>
<p>If you use <code class="docutils literal notranslate"><span class="pre">bash</span></code> with <code class="docutils literal notranslate"><span class="pre">argcomplete</span></code>, obtain a full list by doing: <code class="docutils literal notranslate"><span class="pre">ansible-test</span> <span class="pre">integration</span> <span class="pre">&lt;tab&gt;&lt;tab&gt;</span></code></p>
</div>
</section>
<section id="destructive-tests">
<h2><a class="toc-backref" href="#id8">Destructive Tests</a><a class="headerlink" href="#destructive-tests" title="Permalink to this headline"></a></h2>
<p>These tests are allowed to install and remove some trivial packages.  You will likely want to devote these
to a virtual environment, such as Docker.  They won’t reformat your filesystem:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">ansible-test integration destructive/ --docker fedora34</span>
</pre></div>
</div>
</section>
<section id="windows-tests">
<h2><a class="toc-backref" href="#id9">Windows Tests</a><a class="headerlink" href="#windows-tests" title="Permalink to this headline"></a></h2>
<p>These tests exercise the <code class="docutils literal notranslate"><span class="pre">winrm</span></code> connection plugin and Windows modules.  You’ll
need to define an inventory with a remote Windows Server to use for testing,
and enable PowerShell Remoting to continue.</p>
<p>Running these tests may result in changes to your Windows host, so don’t run
them against a production/critical Windows environment.</p>
<p>Enable PowerShell Remoting (run on the Windows host via Remote Desktop):</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">Enable-PSRemoting -Force</span>
</pre></div>
</div>
<p>Define Windows inventory:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">cp inventory.winrm.template inventory.winrm</span>
<span class="gp">$</span><span class="o">{</span>EDITOR:-vi<span class="o">}</span> inventory.winrm
</pre></div>
</div>
<p>Run the Windows tests executed by our CI system:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">ansible-test windows-integration -v shippable/</span>
</pre></div>
</div>
</section>
<section id="tests-in-containers">
<h2><a class="toc-backref" href="#id10">Tests in containers</a><a class="headerlink" href="#tests-in-containers" title="Permalink to this headline"></a></h2>
<p>If you have a Linux system with Docker or Podman installed, running integration tests using the same containers used by
the Ansible continuous integration (CI) system is recommended.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Podman</p>
<p>By default, Podman will only be used if the Docker CLI is not installed. If you have Docker installed but want to use
Podman, you can change this behavior by setting the environment variable <code class="docutils literal notranslate"><span class="pre">ANSIBLE_TEST_PREFER_PODMAN</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Docker on non-Linux</p>
<p>Using Docker Engine to run Docker on a non-Linux host (such as macOS) is not recommended.
Some tests may fail, depending on the image used for testing.
Using the <code class="docutils literal notranslate"><span class="pre">--docker-privileged</span></code> option when running <code class="docutils literal notranslate"><span class="pre">integration</span></code> (not <code class="docutils literal notranslate"><span class="pre">network-integration</span></code> or <code class="docutils literal notranslate"><span class="pre">windows-integration</span></code>) may resolve the issue.</p>
</div>
<section id="running-integration-tests">
<h3><a class="toc-backref" href="#id11">Running Integration Tests</a><a class="headerlink" href="#running-integration-tests" title="Permalink to this headline"></a></h3>
<p>To run all CI integration test targets for POSIX platforms in a Ubuntu 18.04 container:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">ansible-test integration shippable/ --docker ubuntu1804</span>
</pre></div>
</div>
<p>You can also run specific tests or select a different Linux distribution.
For example, to run tests for the <code class="docutils literal notranslate"><span class="pre">ping</span></code> module on a Ubuntu 18.04 container:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="go">ansible-test integration ping --docker ubuntu1804</span>
</pre></div>
</div>
</section>
<section id="container-images">
<span id="test-container-images"></span><h3><a class="toc-backref" href="#id12">Container Images</a><a class="headerlink" href="#container-images" title="Permalink to this headline"></a></h3>
<p>Container images are updated regularly. To see the current list of container images:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ansible-test integration --help
</pre></div>
</div>
<p>The list is under the <strong>target docker images and supported python version</strong> heading.</p>
</section>
</section>
<section id="legacy-cloud-tests">
<h2><a class="toc-backref" href="#id13">Legacy Cloud Tests</a><a class="headerlink" href="#legacy-cloud-tests" title="Permalink to this headline"></a></h2>
<p>Some of the cloud tests run as normal integration tests, and others run as legacy tests; see the
<a class="reference internal" href="testing_integration_legacy.html#testing-integration-legacy"><span class="std std-ref">Testing using the Legacy Integration system</span></a> page for more information.</p>
</section>
<section id="other-configuration-for-cloud-tests">
<h2><a class="toc-backref" href="#id14">Other configuration for Cloud Tests</a><a class="headerlink" href="#other-configuration-for-cloud-tests" title="Permalink to this headline"></a></h2>
<p>In order to run some tests, you must provide access credentials in a file named
<code class="docutils literal notranslate"><span class="pre">cloud-config-aws.yml</span></code> or <code class="docutils literal notranslate"><span class="pre">cloud-config-cs.ini</span></code> in the test/integration
directory. Corresponding .template files are available for for syntax help.  The newer AWS
tests now use the file test/integration/cloud-config-aws.yml</p>
</section>
<section id="iam-policies-for-aws">
<h2><a class="toc-backref" href="#id15">IAM policies for AWS</a><a class="headerlink" href="#iam-policies-for-aws" title="Permalink to this headline"></a></h2>
<p>Ansible needs fairly wide ranging powers to run the tests in an AWS account.  This rights can be provided to a dedicated user. These need to be configured before running the test.</p>
<section id="testing-policies">
<h3><a class="toc-backref" href="#id16">testing-policies</a><a class="headerlink" href="#testing-policies" title="Permalink to this headline"></a></h3>
<p>The GitHub repository <a class="reference external" href="https://github.com/mattclay/aws-terminator/">mattclay/aws-terminator</a>
contains two sets of policies used for all existing AWS module integratoin tests.
The <cite>hacking/aws_config/setup_iam.yml</cite> playbook can be used to setup two groups:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>ansible-integration-ci</cite> will have the policies applied necessary to run any
integration tests not marked as <cite>unsupported</cite> and are designed to mirror those
used by Ansible’s CI.</p></li>
<li><p><cite>ansible-integration-unsupported</cite> will have the additional policies applied
necessary to run the integration tests marked as <cite>unsupported</cite> including tests
for managing IAM roles, users and groups.</p></li>
</ul>
</div></blockquote>
<p>Once the groups have been created, you’ll need to create a user and make the user a member of these
groups. The policies are designed to minimize the rights of that user.  Please note that while this policy does limit
the user to one region, this does not fully restrict the user (primarily due to the limitations of the Amazon ARN
notation). The user will still have wide privileges for viewing account definitions, and will also able to manage
some resources that are not related to testing (for example, AWS lambdas with different names).  Tests should not
be run in a primary production account in any case.</p>
</section>
<section id="other-definitions-required">
<h3><a class="toc-backref" href="#id17">Other Definitions required</a><a class="headerlink" href="#other-definitions-required" title="Permalink to this headline"></a></h3>
<p>Apart from installing the policy and giving it to the user identity running the tests, a
lambda role <cite>ansible_integration_tests</cite> has to be created which has lambda basic execution
privileges.</p>
</section>
</section>
<section id="network-tests">
<h2><a class="toc-backref" href="#id18">Network Tests</a><a class="headerlink" href="#network-tests" title="Permalink to this headline"></a></h2>
<p>For guidance on writing network test see <a class="reference internal" href="../network/dev_guide/developing_resource_modules_network.html#id3"><span class="std std-ref">Resource module integration tests</span></a>.</p>
</section>
<section id="where-to-find-out-more">
<h2><a class="toc-backref" href="#id19">Where to find out more</a><a class="headerlink" href="#where-to-find-out-more" title="Permalink to this headline"></a></h2>
<p>If you’d like to know more about the plans for improving testing Ansible, join the <a class="reference external" href="https://github.com/ansible/community/blob/master/meetings/README.md">Testing Working Group</a>.</p>
</section>
</section>


           </div>
          </div>
          

<footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Ansible project contributors.
      <span class="lastupdated">Last updated on Jun 27, 2022.
      </span></p>
  </div>

  
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script><!-- extra footer elements for Ansible beyond RTD Sphinx Theme -->
<!-- begin analytics -->
<script>
var _hsq = _hsq || [];
_hsq.push(["setContentType", "standard-page"]);
      (function(d,s,i,r) {
      if (d.getElementById(i)){return;}
      var n = d.createElement(s),e = document.getElementsByTagName(s)[0];
      n.id=i;n.src = 'https://js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/330046.js';
      e.parentNode.insertBefore(n, e);
      })(document, "script", "hs-analytics",300000);
</script>
<!-- end analytics -->
<script>
if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
  _satellite.pageBottom();
}
</script>

</body>
</html>